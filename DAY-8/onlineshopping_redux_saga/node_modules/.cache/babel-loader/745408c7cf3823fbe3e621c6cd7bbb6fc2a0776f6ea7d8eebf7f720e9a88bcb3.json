{"ast":null,"code":"import { call, put, retry, takeLatest } from \"redux-saga/effects\";\nimport { SagaActions } from \"./sagaactions\";\nimport axios from \"axios\";\nimport { deleteProduct, setAllProducts } from \"../redux/slices/products.slices\";\nfunction getProducts() {\n  return axios.get(\"http://localhost:3500/products\");\n}\nfunction* fetchProductsAsync() {\n  try {\n    let response = yield call(getProducts);\n    //   console.log(response.data);\n    yield put(setAllProducts(response.data)); // dispatching the action to reducer\n  } catch (error) {\n    console.log(\"Failed !\");\n  }\n}\nfunction* retryFetchProductsSaga() {\n  try {\n    const SECOND = 1000;\n    const response = yield retry(3, 10 * SECOND, getProducts);\n    yield put(setAllProducts(response.data));\n  } catch (error) {\n    console.log(error);\n  }\n}\nfunction deleteProductFromServer(id) {\n  return axios.delete(\"http://localhost:3500/products/\" + id);\n}\nfunction addProductToServer(product) {\n  axios.post(\"http://localhost:3500/products/\", product);\n}\nfunction* deleteProductAsync(action) {\n  let response = yield call(deleteProductFromServer, action.payload);\n  if (response.status == 200) {\n    yield put(deleteProduct(action.payload));\n  }\n}\nfunction* addNewProductAsync(action) {\n  let response = yield call(addProductToServer, action.payload);\n  console.log(\"here>>\" + response);\n  /*if(response.status == 200) {\n    console.log(\"here\");\n  }*/\n}\n\nexport function* rootSaga() {\n  yield takeLatest(SagaActions.FETCH_PRODUCTS_ASYNC, fetchProductsAsync);\n  // yield takeLatest(SagaActions.FETCH_PRODUCTS_ASYNC, retryFetchProductsSaga);\n  yield takeLatest(SagaActions.DELETE_PRODUCT_ASYNC, deleteProductAsync);\n  yield takeLatest(SagaActions.ADD_PRODUCT_ASYNC, addNewProductAsync);\n}","map":{"version":3,"names":["call","put","retry","takeLatest","SagaActions","axios","deleteProduct","setAllProducts","getProducts","get","fetchProductsAsync","response","data","error","console","log","retryFetchProductsSaga","SECOND","deleteProductFromServer","id","delete","addProductToServer","product","post","deleteProductAsync","action","payload","status","addNewProductAsync","rootSaga","FETCH_PRODUCTS_ASYNC","DELETE_PRODUCT_ASYNC","ADD_PRODUCT_ASYNC"],"sources":["/Users/renyadav/Desktop/Trainings/React Training/Day-1/PS_React_Redux_July_2023/DAY-8/onlineshopping_redux_saga/src/saga/saga.ts"],"sourcesContent":["import { call, put, retry, takeLatest } from \"redux-saga/effects\";\nimport { SagaActions } from \"./sagaactions\";\nimport axios from \"axios\";\nimport { ProductModel } from \"../models/product.model\";\nimport { deleteProduct, setAllProducts } from \"../redux/slices/products.slices\";\nimport { PayloadAction } from \"@reduxjs/toolkit\";\nimport { addProductToCart } from \"../redux/slices/cart.slice\";\n\ntype AxiosResponse = {\n  data: ProductModel[];\n  status: number;\n  statusText: string;\n  headers: any;\n  config: any;\n  request: any;\n};\n\nfunction getProducts() {\n  return axios.get<ProductModel[]>(\"http://localhost:3500/products\");\n}\n\nfunction* fetchProductsAsync() {\n  try {\n    let response: AxiosResponse = yield call(getProducts);\n    //   console.log(response.data);\n    yield put(setAllProducts(response.data)); // dispatching the action to reducer\n  } catch (error) {\n    console.log(\"Failed !\");\n  }\n}\n\nfunction* retryFetchProductsSaga() {\n  try {\n    const SECOND = 1000;\n    const response: AxiosResponse = yield retry(3, 10 * SECOND, getProducts);\n    yield put(setAllProducts(response.data));\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nfunction deleteProductFromServer(id: number) {\n  return axios.delete(\"http://localhost:3500/products/\" + id);\n}\nfunction addProductToServer(product:ProductModel){\n  axios.post(\"http://localhost:3500/products/\", product)\n}\nfunction* deleteProductAsync(action: PayloadAction<number>) {\n  let response: AxiosResponse = yield call(\n    deleteProductFromServer,\n    action.payload,\n  );\n  if (response.status == 200) {\n    yield put(deleteProduct(action.payload));\n  }\n}\n\nfunction* addNewProductAsync(action:PayloadAction<ProductModel>) {\n\n  let response: AxiosResponse = yield call(addProductToServer, action.payload);\n\n  console.log(\"here>>\" + response);\n  /*if(response.status == 200) {\n    console.log(\"here\");\n  }*/\n\n}\n\nexport function* rootSaga() {\n  yield takeLatest(SagaActions.FETCH_PRODUCTS_ASYNC, fetchProductsAsync);\n  // yield takeLatest(SagaActions.FETCH_PRODUCTS_ASYNC, retryFetchProductsSaga);\n  yield takeLatest(SagaActions.DELETE_PRODUCT_ASYNC, deleteProductAsync);\n  yield takeLatest(SagaActions.ADD_PRODUCT_ASYNC, addNewProductAsync);\n}\n"],"mappings":"AAAA,SAASA,IAAI,EAAEC,GAAG,EAAEC,KAAK,EAAEC,UAAU,QAAQ,oBAAoB;AACjE,SAASC,WAAW,QAAQ,eAAe;AAC3C,OAAOC,KAAK,MAAM,OAAO;AAEzB,SAASC,aAAa,EAAEC,cAAc,QAAQ,iCAAiC;AAa/E,SAASC,WAAWA,CAAA,EAAG;EACrB,OAAOH,KAAK,CAACI,GAAG,CAAiB,gCAAgC,CAAC;AACpE;AAEA,UAAUC,kBAAkBA,CAAA,EAAG;EAC7B,IAAI;IACF,IAAIC,QAAuB,GAAG,MAAMX,IAAI,CAACQ,WAAW,CAAC;IACrD;IACA,MAAMP,GAAG,CAACM,cAAc,CAACI,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,CAAC;EAC5C,CAAC,CAAC,OAAOC,KAAK,EAAE;IACdC,OAAO,CAACC,GAAG,CAAC,UAAU,CAAC;EACzB;AACF;AAEA,UAAUC,sBAAsBA,CAAA,EAAG;EACjC,IAAI;IACF,MAAMC,MAAM,GAAG,IAAI;IACnB,MAAMN,QAAuB,GAAG,MAAMT,KAAK,CAAC,CAAC,EAAE,EAAE,GAAGe,MAAM,EAAET,WAAW,CAAC;IACxE,MAAMP,GAAG,CAACM,cAAc,CAACI,QAAQ,CAACC,IAAI,CAAC,CAAC;EAC1C,CAAC,CAAC,OAAOC,KAAK,EAAE;IACdC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;EACpB;AACF;AAEA,SAASK,uBAAuBA,CAACC,EAAU,EAAE;EAC3C,OAAOd,KAAK,CAACe,MAAM,CAAC,iCAAiC,GAAGD,EAAE,CAAC;AAC7D;AACA,SAASE,kBAAkBA,CAACC,OAAoB,EAAC;EAC/CjB,KAAK,CAACkB,IAAI,CAAC,iCAAiC,EAAED,OAAO,CAAC;AACxD;AACA,UAAUE,kBAAkBA,CAACC,MAA6B,EAAE;EAC1D,IAAId,QAAuB,GAAG,MAAMX,IAAI,CACtCkB,uBAAuB,EACvBO,MAAM,CAACC,OACT,CAAC;EACD,IAAIf,QAAQ,CAACgB,MAAM,IAAI,GAAG,EAAE;IAC1B,MAAM1B,GAAG,CAACK,aAAa,CAACmB,MAAM,CAACC,OAAO,CAAC,CAAC;EAC1C;AACF;AAEA,UAAUE,kBAAkBA,CAACH,MAAkC,EAAE;EAE/D,IAAId,QAAuB,GAAG,MAAMX,IAAI,CAACqB,kBAAkB,EAAEI,MAAM,CAACC,OAAO,CAAC;EAE5EZ,OAAO,CAACC,GAAG,CAAC,QAAQ,GAAGJ,QAAQ,CAAC;EAChC;AACF;AACA;AAEA;;AAEA,OAAO,UAAUkB,QAAQA,CAAA,EAAG;EAC1B,MAAM1B,UAAU,CAACC,WAAW,CAAC0B,oBAAoB,EAAEpB,kBAAkB,CAAC;EACtE;EACA,MAAMP,UAAU,CAACC,WAAW,CAAC2B,oBAAoB,EAAEP,kBAAkB,CAAC;EACtE,MAAMrB,UAAU,CAACC,WAAW,CAAC4B,iBAAiB,EAAEJ,kBAAkB,CAAC;AACrE"},"metadata":{},"sourceType":"module","externalDependencies":[]}